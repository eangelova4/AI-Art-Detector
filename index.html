<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI Art Detector</title>

<!-- Retro Windows 98 style -->
<style>
    body {
        font-family: "MS Sans Serif", Arial, sans-serif;
        background: #008080;
        margin: 0;
        padding: 20px;
        color: black;
    }

    .window {
        background: #c0c0c0;
        border: 2px solid #fff;
        border-right-color: #404040;
        border-bottom-color: #404040;
        padding: 10px;
        width: 650px;
        margin: auto;
    }

    .title-bar {
        background: navy;
        color: white;
        padding: 5px;
        font-weight: bold;
    }

    .content {
        padding: 10px;
        background: #e0e0e0;
        border: 2px inset #808080;
    }

    input[type="file"], button {
        margin-top: 10px;
        width: 100%;
        font-size: 14px;
    }

    #preview-container img, #webcam-container canvas {
        width: 100%;
        margin-top: 10px;
    }

    #result-box {
        background: white;
        padding: 10px;
        border: 2px inset #808080;
        margin-top: 15px;
    }

    footer {
        text-align: center;
        margin-top: 20px;
        color: white;
        font-size: 14px;
    }
</style>

<!-- TensorFlow + Teachable Machine -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest"></script>

</head>
<body>

<div class="window">
    <div class="title-bar">AI Art Detector</div>
    <div class="content">

        <h3>What this tool does</h3>
        <p>
            AI tools have become extremely advanced, making it difficult to tell whether a piece of art is human-made 
            or created by an artificial intelligence system.  
            This website uses a Google Teachable Machine image classifier to help users quickly analyze artwork.
        </p>

        <h3>How to use it</h3>
        <p>
            1. You can either <b>upload an image</b> or <b>use your webcam</b> to analyze art.<br>
            2. The model will process the image directly in your browser.<br>
            3. You will see the probability that the image is AI-generated or Human-made.
        </p>

        <input type="file" id="imageUpload" accept="image/*">
        <button id="startWebcam">Use Webcam</button>

        <div id="preview-container"></div>
        <div id="webcam-container"></div>
        <div id="result-box"></div>

    </div>
</div>

<footer>
    © <span id="yourNameHere">YOUR NAME HERE</span> — Replace with your name.
</footer>

<script>
    const URL = "./my_model/"; // Your Teachable Machine model folder
    let model, maxPredictions, webcam;

    async function loadModel() {
        const modelURL = URL + "model.json";
        const metadataURL = URL + "metadata.json";

        model = await tmImage.load(modelURL, metadataURL);
        maxPredictions = model.getTotalClasses();
        console.log("Model loaded successfully!");
    }

    loadModel();

    // ================= IMAGE UPLOAD =================
    document.getElementById("imageUpload").addEventListener("change", async function(event) {
        const file = event.target.files[0];
        if (!file) return;

        // Stop webcam if active
        if (webcam) {
            webcam.stop();
            document.getElementById("webcam-container").innerHTML = "";
        }

        const img = document.createElement("img");
        img.src = URL.createObjectURL(file);

        const previewContainer = document.getElementById("preview-container");
        previewContainer.innerHTML = "";
        previewContainer.appendChild(img);

        img.onload = async () => {
            const prediction = await model.predict(img);
            let aiArtProb = 0;
            let humanArtProb = 0;

            prediction.forEach(p => {
                if (p.className === "AI Art") aiArtProb = (p.probability*100).toFixed(1);
                if (p.className === "Human Art") humanArtProb = (p.probability*100).toFixed(1);
            });

            document.getElementById("result-box").innerHTML = `
                <b>Results:</b><br>
                AI Art: <b>${aiArtProb}%</b><br>
                Human Art: <b>${humanArtProb}%</b>
            `;
        };
    });

    // ================= WEBCAM =================
    document.getElementById("startWebcam").addEventListener("click", async function() {
        // Stop previous webcam if exists
        if (webcam) webcam.stop();

        // Clear uploaded preview
        document.getElementById("preview-container").innerHTML = "";

        webcam = new tmImage.Webcam(320, 320, true); // width, height, flip
        await webcam.setup();
        await webcam.play();
        document.getElementById("webcam-container").innerHTML = "";
        document.getElementById("webcam-container").appendChild(webcam.canvas);

        window.requestAnimationFrame(loop);
    });

    async function loop() {
        webcam.update();
        await predictWebcam();
        window.requestAnimationFrame(loop);
    }

    async function predictWebcam() {
        const prediction = await model.predict(webcam.canvas);

        let aiArtProb = 0;
        let humanArtProb = 0;

        prediction.forEach(p => {
            if (p.className === "AI Art") aiArtProb = (p.probability*100).toFixed(1);
            if (p.className === "Human Art") humanArtProb = (p.probability*100).toFixed(1);
        });

        document.getElementById("result-box").innerHTML = `
            <b>Results:</b><br>
            AI Art: <b>${aiArtProb}%</b><br>
            Human Art: <b>${humanArtProb}%</b>
        `;
    }
</script>

</body>
</html>
